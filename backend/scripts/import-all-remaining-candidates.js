const db = require('../config/database');

// Complete CSV data for all remaining parties (JJD, VIP, INC, RJD, AAP, AIMIM, CPIM, CPIML)
const allRemainingCandidates = {
  'JJD': [
    ['महुआ', 'तेज प्रताप यादव'],
    ['बेलसंड', 'विकास कुमार कवि'],
    ['शाहपुर', 'मदन यादव'],
    ['बख्तियारपुर', 'डॉ. गुलशन यादव'],
    ['बिक्रम', 'अजीत कुशवाहा'],
    ['जहानाबाद', 'मीराँ रज़ा'],
    ['बाराचट्टी', 'अभिनव'],
    ['बेलागंज', 'प्रेम कुमार'],
    ['बेनीपुर', 'अभय किशोर झा'],
    ['मनेर', 'शंकर यादव'],
    ['डुमराँव', 'दिनेश कुमार सूर्या'],
    ['नरकटियागंज', 'आशुतोष'],
    ['पटना साहिब', 'सुमन कुमारी'],
    ['मधुबनी', 'संजय यादव'],
    ['बिक्रमगंज', 'डॉ. गुलशन यादव'],
    ['बिक्रमगंज', 'अजीत कुशवाहा'],
    ['मोहिउद्दीन नगर', 'सुरभि यादव']
  ],
  'VIP': [
    ['गौड़ाबौराम', 'श्री संतोष सहनी'],
    ['आलमनगर', 'श्री नवीन कुमार'],
    ['कुशेश्वरस्थान', 'श्री गणेश भारती सदा'],
    ['दरभंगा', 'श्री उमेश सहनी'],
    ['औराई', 'श्री भोगेन्द्र सहनी'],
    ['बरुराज', 'श्री राकेश कुमार'],
    ['चैनपुर', 'श्री बालगोविंद बिंद'],
    ['लौरिया', 'श्री रण कौशल प्रताप सिंह'],
    ['सुगौली', 'श्री शशि भूषण सिंह'],
    ['केसरिया', 'श्री वरुण विजय'],
    ['सिकटी', 'श्री हरिनारायण प्रमाणिक'],
    ['कटिहार', 'श्री सौरभ अग्रवाल'],
    ['बिहपुर', 'श्री अर्पणा कुमारी मंडल'],
    ['गोपालपुर', 'श्री प्रेम सागर'],
    ['बाबूबरही', 'सुश्री बिंदु गुलाब यादव']
  ],
  'INC': [
    ['बगहा', 'जयेश मंगल सिंह'],
    ['नौतन', 'अमित गिरी'],
    ['चनपटिया', 'अभिषेक रंजन'],
    ['बेतिया', 'वसी अहमद'],
    ['रक्सौल', 'श्याम बिहारी प्रसाद'],
    ['गोविंदगंज', 'शशि भूषण राय'],
    ['रीगा', 'अमित कुमार सिंह टुन्ना'],
    ['बथनाहा', 'ई. नवीन कुमार'],
    ['बेनीपट्टी', 'नलिनी रंजन झा'],
    ['फुलपरास', 'सुबोध मंडल'],
    ['फोरबिसगंज', 'मनोज विश्वास'],
    ['बहादुरगंज', 'प्रो. मसवर आलम @प्रो. मुशब्बिर आलम'],
    ['कदवा', 'शकील अहमद खान'],
    ['मनहारी', 'मनोहर प्रसाद सिंह'],
    ['कोरहा', 'सुश्री पूनम पासवान'],
    ['सोनबरसा', 'सुश्री सरिता देवी'],
    ['बेनीपुर', 'मिथिलेश कुमार चौधरी'],
    ['सकरा', 'उमेश राम'],
    ['मुजफ्फरपुर', 'बिजेंद्र चौधरी'],
    ['गोपालगंज', 'ओम प्रकाश गर्ग'],
    ['कुचायकोट', 'हरि नारायण कुशवाहा'],
    ['लालगंज', 'आदित्य कुमार राजा'],
    ['वैशाली', 'ई. संजीव सिंह'],
    ['राजा पाकर', 'सुश्री प्रतिमा कुमारी'],
    ['रोसड़ा', 'ब्रज किशोर रवि'],
    ['बछवारा', 'शिव प्रकाश गरीब दास'],
    ['बेगूसराय', 'सुश्री अमिता भूषण'],
    ['खगड़िया', 'डॉ. चंदन यादव'],
    ['बेलदौर', 'मिथिलेश कुमार निषाद'],
    ['भागलपुर', 'अजीत कुमार शर्मा'],
    ['सुल्तानगंज', 'ललन यादव'],
    ['अमरपुर', 'जितेंद्र सिंह'],
    ['लखीसराय', 'अमरेश कुमार (अनीश)'],
    ['बरबीघा', 'त्रिशूलधारी सिंह'],
    ['बिहारशरीफ', 'उमेर खान'],
    ['नालंदा', 'कौशलेन्द्र कुमार "छोटे मुखिया"'],
    ['हरनौत', 'अरुण कुमार बिंद'],
    ['कुम्हरार', 'इंद्रदीप चंद्रवंशी'],
    ['पटना साहिब', 'शशांक शेखर'],
    ['बिक्रम', 'अनिल कुमार सिंह'],
    ['बक्सर', 'संजय कुमार तिवारी'],
    ['राजपुर', 'विश्वनाथ राम'],
    ['चेनारी', 'मंगल राम'],
    ['करगहर', 'संतोष मिश्रा'],
    ['कुटुंबा', 'राजेश राम'],
    ['औरंगाबाद', 'आनंद शंकर सिंह'],
    ['वजीरगंज', 'अवधेश कुमार सिंह'],
    ['हिसुआ', 'सुश्री नीतू कुमारी'],
    ['नरकटियागंज', 'शाश्वत केदार पाण्डेय'],
    ['किशनगंज', 'मो. कमरुल् हुदा'],
    ['कस्बा', 'मो. इरफान आलम'],
    ['पूर्णिया', 'जितेन्द्र यादव'],
    ['गया टाउन', 'मोहन श्रीवास्तव'],
    ['वाल्मीकि नगर', 'सुरेन्द्र प्रसाद कुशवाहा'],
    ['अररिया', 'अबिदुर रहमान'],
    ['अमौर', 'जलील मस्तान'],
    ['बरारी', 'तौकीर आलम'],
    ['कहलगाँव', 'प्रवीण सिंह कुशवाहा'],
    ['सिकंदरा', 'विनोद चौधरी']
  ],
  'RJD': [
    ['राघोपुर', 'तेजस्वी प्रसाद यादव'],
    ['बिहारीगंज', 'रेणू कुशवाहा'],
    ['बैसी', 'अब्दुस सुब्हान'],
    ['बोचहां', 'अमर पासवान'],
    ['वरसलीगंज', 'अनिता देवी महतो'],
    ['तरैया', 'शैलेन्द्र प्रताप सिंह'],
    ['महिषी', 'गौतम कृष्ण BDO'],
    ['झाझा', 'जय प्रकाश यादव'],
    ['अलीनगर', 'विनोद मिश्रा'],
    ['अस्थावां', 'रवि रंजन कुमार'],
    ['मटिहानी', 'बोगो सिंह'],
    ['दरभंगा ग्रामीण', 'ललित यादव'],
    ['कुरहनी', 'बबलू कुशवाहा'],
    ['केवटी', 'डॉ फराज फातमी'],
    ['गायघाट', 'निरंजन राय'],
    ['सिमरी बख्तियारपुर', 'यूसुफ सल्लाउद्दीन'],
    ['हसनपुर', 'माला पुष्पम'],
    ['मधेपुरा', 'प्रो चंद्रशेखर'],
    ['मधुबन', 'संध्या रानी कुशवाहा'],
    ['इमामगंज', 'ऋतु प्रिया चौधरी'],
    ['बाराचट्टी', 'तनुश्री मांझी'],
    ['कांटी', 'इसराइल मंसूरी'],
    ['हथुआ', 'राजेश कुशवाहा'],
    ['साहेबगंज', 'पृथ्वी राय'],
    ['सिंहेश्वर', 'चंद्रहास चौपाल'],
    ['बैकुंठपुर', 'प्रेम शंकर यादव'],
    ['बाराुली', 'दिलीप सिंह'],
    ['हाजीपुर', 'देव कुमार चौरेसिया'],
    ['बहादुरपुर', 'भोला यादव'],
    ['सीवान', 'अवध बिहारी चौधरी'],
    ['बरहरिया', 'अरुण गुप्ता'],
    ['मीनापुर', 'मुन्ना यादव'],
    ['रघुनाथपुर', 'ओसामा शहाब'],
    ['छपरा', 'शत्रुघ्न कुमार उर्फ खेसारी लाल'],
    ['गरखा', 'सुरेन्द्र राम'],
    ['महराजगंज', 'विशाल जायसवाल'],
    ['एकमा', 'श्रीकांत यादव'],
    ['बनियापुर', 'चंद्रनी देवी सिंह'],
    ['अतरी', 'वैजयंती देवी'],
    ['रजौली', 'पिंकी चौधरी'],
    ['पारू', 'शंकर यादव'],
    ['मरहौरा', 'जितेन्द्र राय'],
    ['गोरियाकोठी', 'अनवारुल हक़ अंसारी'],
    ['लालगंज', 'शिवानी शुक्ला'],
    ['परसा', 'डॉ करिश्मा राय'],
    ['सोनपुर', 'डॉ रामानुज प्रसाद'],
    ['सरायरंजन', 'अरविन्द साहनी'],
    ['मोरवा', 'रामविजय साहू'],
    ['चेरिया-बरियारपुर', 'सुशील सिंह कुशवाहा'],
    ['उजियारपुर', 'आलोक मेहता'],
    ['महुआ', 'डॉ मुकेश रौशन'],
    ['आलाउली', 'रामविरकिश सदा'],
    ['महनार', 'रविन्द्र सिंह'],
    ['पातेपुर', 'प्रेमा चौधरी'],
    ['तारापुर', 'अख्तरुल इस्लाम शाहीन'],
    ['मुंगेर', 'अरुण शाह'],
    ['अमनौर', 'सुनील राय'],
    ['मोकामा', 'वीना देवी'],
    ['मोहिउद्दीननगर', 'डॉ एजिया यादव'],
    ['वैशाली', 'अजय कुशवाहा'],
    ['साहेबपुर कमाल', 'सतानंद सम्बुद्ध'],
    ['बरबीघा', 'कर्मवीर सिंह'],
    ['मुंगेर', 'अविनाश विद्यार्थी'],
    ['परबत्ता', 'डॉ संजीव सिंह'],
    ['सूर्यगढ़ा', 'प्रेम सागर चौधरी'],
    ['मनेर', 'भाई बिरेंद्र'],
    ['इस्लामपुर', 'राकेश रौशन'],
    ['शेखपुरा', 'विजय सम्पत'],
    ['मसौढ़ी', 'रेखा पासवान'],
    ['नरकटिया', 'डॉ शमीम अहमद'],
    ['हिलसा', 'शक्ती सिंह'],
    ['हरसिद्धि', 'राजेन्द्र राम'],
    ['दानापुर', 'रित्तात राय'],
    ['बख्तियारपुर', 'अनिरुद्ध यादव'],
    ['बांकीपुर', 'रेखा गुप्ता'],
    ['गोबिंदपुर', 'पूर्णिमा देवी'],
    ['फतुहा', 'डॉ रामानंद यादव'],
    ['नरकटियागंज', 'सुबोध पासवान'],
    ['कल्याणपुर', 'मनोज यादव'],
    ['मोतिहारी', 'देवा गुप्ता'],
    ['सन्देश', 'दिपु रावत'],
    ['नरकटियागंज', 'दीपक यादव'],
    ['बरहरा', 'रामबाबू पासवान'],
    ['जगदीशपुर', 'कुणाल किशोर'],
    ['शाहपुर', 'राहुल तिवारी'],
    ['ब्रह्मपुर', 'शम्भू नाथ'],
    ['चिरैया', 'लक्ष्मी नारायण प्रसाद'],
    ['ढाका', 'फैसल रहमान'],
    ['शेओहर', 'नवनीत झा'],
    ['परिहार', 'स्मिता पूर्वे गुप्ता'],
    ['सुरसंड', 'सैयद अबू दोजाना'],
    ['बाजपट्टी', 'मुकेश यादव'],
    ['सीतामढ़ी', 'सुनील कुशवाहा'],
    ['रुन्नीसैदपुर', 'चन्दन कुमार'],
    ['बेलसंड', 'संजय गुप्ता'],
    ['खजौली', 'ब्रिज किशोर यादव'],
    ['बाबूबरही', 'अरुण कुशवाहा'],
    ['बिस्फी', 'आसिफ अहमद'],
    ['मधुबनी', 'समीर महासेठ'],
    ['राजनगर', 'प्रोफ़ विष्णु राम'],
    ['लौकहा', 'भारत भूषण मंडल'],
    ['त्रिबेनीगंज', 'संतोष सरदार'],
    ['छातापुर', 'डॉ विपिन कुमार नोनिया'],
    ['निर्मली', 'बैजनाथ मेहता श्री, IRS'],
    ['नरपतगंज', 'मनोज यादव'],
    ['रानीगंज', 'अवधेश मंगलम'],
    ['जोकीहाट', 'शहनवाज़ आलम'],
    ['ठाकुरगंज', 'सौद आलम'],
    ['कोचाधामन', 'मुजाहिद आलम'],
    ['रुपौली', 'बीमा भारती'],
    ['धमदाहा', 'संतोष कुशवाहा'],
    ['प्राणपुर', 'इशरत परवीन'],
    ['पिरपैंती', 'राम विलास पासवान'],
    ['कहलगांव', 'राजनीश भारती'],
    ['सुलतानगंज', 'चन्दन सिन्हा'],
    ['नथनगर', 'शेख ज़ेयौल हसन'],
    ['धोरैया', 'त्रिभुवन दास'],
    ['कटोरिया', 'स्वीटी सीमा हेमब्रम'],
    ['बेलहर', 'चाणक्य प्रकाश रंजन'],
    ['नरहट', 'अजीत सिंह'],
    ['मोहनिया', 'श्वेता सुमन'],
    ['भभुआ', 'बिरेंदर कुशवाहा'],
    ['चैनपुर', 'ब्रिज किशोर बिंद'],
    ['सासाराम', 'सतेंदर साह'],
    ['दिनारा', 'राजेश यादव'],
    ['नोखा', 'अनीता देवी नोनिया'],
    ['चकाई', 'सावित्री देवी'],
    ['देहरी', 'गुड्डू चंद्रवंशी'],
    ['कुर्था', 'सुदय यादव'],
    ['जहानाबाद', 'राहुल शर्मा'],
    ['मखदुमपुर', 'सुबेदर दास'],
    ['गोह', 'अमरेंद्रर कुशवाहा'],
    ['ओबरा', 'ऋषि कुमार'],
    ['नबीनगर', 'अमोद चंद्रवंशी'],
    ['रफीगंज', 'डॉ गुलाम शाहिद'],
    ['गुरुआ', 'विनय कुमार'],
    ['शेरघाटी', 'प्रमोद वर्मा'],
    ['बोध गया', 'कुमार सरजीत पासवान'],
    ['टिकारी', 'अजय डांगी'],
    ['बेलागंज', 'विश्वनाथ कुमार सिंह'],
    ['नवादा', 'कौशल यादव'],
    ['जमुई', 'शमशाद आलम'],
    ['सिकंदरा', 'उदय नारायण चौधरी']
  ],
  'AAP': [
    ['नरकटियागंज', 'राजीव वर्मा'],
    ['बगहा', 'शेषनाथ चौधरी'],
    ['लौरिया', 'शशि भूषण तिवारी'],
    ['बेतिया', 'अर्जुन कुमार सिन्हा'],
    ['सिकटा', 'औरंगजेब आलम'],
    ['सुगौली', 'ग्यासुद्दीन समैनी'],
    ['नरकटिया', 'ईश्वर चंद त्रिपाठी'],
    ['गोविंदगंज', 'अशोक कुमार सिंह'],
    ['केसरिया', 'राम आधार राय'],
    ['कल्याणपुर', 'राम बाबू दास'],
    ['पिपरा', 'विपुल यादव'],
    ['मधुबन', 'भगवान शाह'],
    ['मोतिहारी', 'अभिषेक कुमार'],
    ['चिरैया', 'ओम प्रकाश यादव'],
    ['ढाका', 'मधुसूदन कुशवाहा'],
    ['शिवहर', 'अनीश झा'],
    ['परिहार', 'अभिषेक नारायण ठाकुर'],
    ['सुरसंड', 'ऋषि कुमार अग्रवाल'],
    ['बाजपट्टी', 'रणधीर कुमार चौधरी'],
    ['सीतामढ़ी', 'रानी देवी'],
    ['बेनीपट्टी', 'शुभदा यादव'],
    ['खजौली', 'आशा सिंह'],
    ['बिस्फी', 'अरविंद कुमार मिश्रा'],
    ['मधुबनी', 'रजनी मिश्रा'],
    ['राजनगर', 'अजय पासवान'],
    ['झंझारपुर', 'देवकांत झा'],
    ['फुलपरास', 'गौरीशंकर'],
    ['निर्मली', 'चंदन कुमार'],
    ['पिपरा', 'रवि शंकर गुड्डू'],
    ['सुपौल', 'ब्रज भूषण (नवीन)'],
    ['छातापुर', 'विनोद कुमार मंडल'],
    ['फारबिसगंज', 'अबू रहमत अली'],
    ['अररिया', 'चन्द्र भूषण'],
    ['सिकटी', 'दिनेश कुमार आर्य'],
    ['बहादुरगंज', 'मासूम रज़ा'],
    ['किशनगंज', 'अशरफ आलम'],
    ['अमौर', 'मो. मुंतजिर आलम'],
    ['कस्बा', 'भानु भारतीया'],
    ['रूपौली', 'विकास कुमार'],
    ['पूर्णिया', 'आदित्य लाल'],
    ['कटिहार', 'राजेश गुरनानी'],
    ['मनिहारी', 'मालिनी मंडल'],
    ['बिहारीगंज', 'दिलीप कुमार'],
    ['सिंहेश्वर', 'नंद कुमार'],
    ['मधेपुरा', 'मुकेश कुमार'],
    ['महिषी', 'विलास कुमार गुप्ता'],
    ['कुशेश्वर स्थान', 'योगी चौपाल'],
    ['अलीनगर', 'राजीव पाल झा'],
    ['हायाघाट', 'रविन्द्रनाथ सिंह'],
    ['औराई', 'शिवम शंकर गुप्ता'],
    ['मुजफ्फरपुर', 'मो. हसन'],
    ['बोचहां', 'डॉ. अभय कुमार'],
    ['बैकुंठपुर', 'ओम प्रकाश राय'],
    ['बरौली', 'डॉ. सत्येन्द्र कुमार पटेल'],
    ['गोपालगंज', 'डॉ. ब्रज किशोर गुप्ता'],
    ['भोरे', 'धर्मेन्द्र कुमार'],
    ['हथुआ', 'इंद्रजीत ज्योतिकर'],
    ['सीवान', 'सत्येन्द्र कुमार कुशवाहा'],
    ['जीरादेई', 'विनोद कुमार सिंह'],
    ['बरहरिया', 'डॉ. जितेंद्र कुमार यादव'],
    ['गोरियाकोठी', 'रवि भूषण गुप्ता'],
    ['तरैया', 'अमित कुमार सिंह'],
    ['मढ़ौरा', 'सुशील कुमार यादव'],
    ['छपरा', 'प्रेम प्राप्त सिंह'],
    ['गरखा', 'सदन कुमार'],
    ['परसा', 'पवन तिवारी'],
    ['हाजीपुर', 'राज कुमार पासवान'],
    ['लालगंज', 'राजेन्द्र प्रसाद सिंह'],
    ['राघोपुर', 'राजू कुमार'],
    ['महनार', 'विपिन कुमार'],
    ['पातेपुर', 'ओम प्रकाश दास'],
    ['वारिसनगर', 'उपेन्द्र कुमार राय'],
    ['समस्तीपुर', 'रंजन कुमार'],
    ['उजियारपुर', 'अंकित कुमार मिश्रा'],
    ['मोरवा', 'टुनटुन राय'],
    ['मोहिउद्दीननगर', 'उमेश राय'],
    ['बिभूतिपुर', 'अरुण कुमार'],
    ['हसनपुर', 'मनमोहन मधुकर'],
    ['बछवाड़ा', 'अभिषेक कुमार भट्ट'],
    ['बेगूसराय', 'डॉ. मीरा सिंह'],
    ['बेलदौर', 'राहुल कुमार बसु'],
    ['पीरपैंती', 'प्रीतम कुमार'],
    ['अमरपुर', 'मो. जाकिर हुसैन'],
    ['बांका', 'रजनीश कुमार चौधरी'],
    ['तारापुर', 'राहुल कुमार सिंह'],
    ['जमालपुर', 'गोपाल कुमार तांती'],
    ['शेखपुरा', 'उमेश प्रसाद सिंह'],
    ['बिहारशरीफ', 'मनोज कुमार'],
    ['हरनौत', 'धर्मेन्द्र कुमार'],
    ['मोकामा', 'डॉ. राजेश कुमार रत्नाकर'],
    ['बख्तियारपुर', 'अरुण ठाकुर'],
    ['बाँकीपुर', 'डॉ. पंकज कुमार'],
    ['कुम्हरार', 'बबलू कुमार'],
    ['फुलवारी', 'अरुण कुमार रजक'],
    ['मसौढ़ी', 'विकास पासवान'],
    ['पालीगंज', 'शिव नाथ कुमार'],
    ['तरारी', 'संजय शर्मा'],
    ['बक्सर', 'पूर्व कैप्टन धर्मराज सिंह'],
    ['मोहनिया', 'रंजीत डोम'],
    ['भभुआ', 'अमीरूद्दीन अंसारी'],
    ['चैनपुर', 'राम राज विश्वकर्मा'],
    ['चेनारी', 'धनंजय कुमार'],
    ['सासाराम', 'आराम खान'],
    ['करगहर', 'परमहंस तिवारी'],
    ['कुर्था', 'उमाशंकर शरण'],
    ['जहानाबाद', 'बलेश्वर सिंह'],
    ['घोसी', 'प्रमोद कुमार'],
    ['कुटुंबा', 'श्रावण घुईया'],
    ['गुरुआ', 'सच्चितानंद श्याम'],
    ['शेरघाटी', 'मनोज कुमार'],
    ['इमामगंज', 'ऋषिक भारती'],
    ['बोध गया', 'गोवर्धन मांझी'],
    ['गया टाउन', 'अनिल कुमार'],
    ['बेलागंज', 'मधुमाला कुमारी'],
    ['वजीरगंज', 'अनिकेत राज'],
    ['रजौली', 'डॉ. रंजीत कुमार'],
    ['सिकंदरा', 'राहुल राणा'],
    ['जमुई', 'रामाशीष यादव']
  ],
  'AIMIM': [
    ['अमौर', 'अख्तरुल ईमान'],
    ['बलरामपुर', 'आदिल हसन'],
    ['ढाका', 'राणा रणजीत सिंह'],
    ['नरकटिया', 'शमीमुल हक'],
    ['गोपालगंज', 'अनस सलाम'],
    ['जोकीहाट', 'मुर्शीद आलम'],
    ['बहादुरगंज', 'तौसीफ आलम'],
    ['ठाकुरगंज', 'गुलाम हसनैन'],
    ['किशनगंज', 'एडवोकेट शम्स आगाज़'],
    ['बैसी', 'गुलाम सरवर'],
    ['शेरघाटी', 'शान-ए-अली खान'],
    ['नाथनगर', 'मोहम्मद इस्माइल'],
    ['सीवान', 'मोहम्मद कैफ'],
    ['केवटी', 'अनीसुर रहमान'],
    ['जाले', 'फैसल रहमान'],
    ['सिकंदरा', 'मनोज कुमार दास'],
    ['मुंगेर', 'डॉ. मुनाजिर हसन'],
    ['नवादा', 'नसीमा खातून'],
    ['मधुबनी', 'राशिद खलील अंसारी'],
    ['दरभंगा ग्रामीण', 'मोहम्मद जलाल'],
    ['गौड़ाबौराम', 'अख्तर शहंशाह'],
    ['कस्बा', 'शाहनवाज़ आलम'],
    ['अररिया', 'मोहम्मद मंज़ूर आलम'],
    ['बरारी', 'मतीउर रहमान शेरशाहबादी'],
    ['कोचाधामन', 'सरवर आलम']
  ],
  'CPIM': [
    ['विभूतिपुर', 'कॉम. अजय कुमार'],
    ['हायाघाट', 'कॉम. श्याम भारती'],
    ['पिपरा', 'कॉम. राजमंगल प्रसाद'],
    ['मांझी', 'कॉम. सत्येंद्र यादव']
  ],
  'CPIML': [
    ['भोरे', 'धनंजय'],
    ['जीरादेई', 'अमरजीत कुशवाहा'],
    ['दरौली', 'सत्यदेव राम'],
    ['दरौंदा', 'अमरनाथ यादव'],
    ['कल्याणपुर', 'रंजीत कुमार राम'],
    ['वारिसनगर', 'फूलबाबू सिंह'],
    ['राजगीर', 'बिश्वनाथ चौधरी'],
    ['दीघा', 'दिव्या गौतम'],
    ['फुलवारी', 'गोपाल रवि दास'],
    ['पालीगंज', 'संदीप सौरभ'],
    ['अरराह', 'क़यामुद्दीन अंसारी'],
    ['अगिआंव', 'शिव प्रकाश रंजन'],
    ['तरारी', 'मदन सिंह'],
    ['डुमरांव', 'अजीत कुमार सिंह'],
    ['सिकटा', 'बीरेंद्र प्रसाद गुप्ता'],
    ['पिपरा', 'अनिल कुमार'],
    ['बलरामपुर', 'महबूब आलम'],
    ['काराकाट', 'अरुण सिंह'],
    ['अरवल', 'महानंद सिंह'],
    ['घोसी', 'राम बली सिंह यादव']
  ]
};

// Constituency name mapping (comprehensive - includes SC/ST suffixes)
const nameMapping = {
  // With SC/ST/OBC suffixes
  'बोचहां': 'बोचहां (अजा)',
  'बाराचट्टी': 'बाराचट्टी (अजा)',
  'कुशेश्वरस्थान': 'कुशेश्वर स्थान (अजा)',
  'कुशेश्वर स्थान': 'कुशेश्वर स्थान (अजा)',
  'मनहारी': 'मनिहारी (अजजा)',
  'मनिहारी': 'मनिहारी (अजजा)',
  'बथनाहा': 'बैठनहा (अजा)',
  'कोरहा': 'कोराह (अजा)',
  'सोनबरसा': 'सोनबरसा (अजा)',
  'सकरा': 'सखरा (अजा)',
  'राजा पाकर': 'राजापाकर (अजा)',
  'राजपुर': 'राजपुर (अजा)',
  'रोसड़ा': 'रोसरा (अजा)',
  'बछवारा': 'बछवाड़ा (अजा)',
  'बछवाड़ा': 'बछवाड़ा (अजा)',
  'चेनारी': 'चैनपुर (अजा)',
  'कुटुंबा': 'कुटुंबा (अजा)',
  'इमामगंज': 'इमामगंज (अजा)',
  'सिंहेश्वर': 'सिंहेश्वर (अजा)',
  'पातेपुर': 'पातेपुर (अजा)',
  'आलाउली': 'अलौली (अजा)',
  'रजौली': 'रजौली (अजा)',
  'मसौढ़ी': 'मसौढ़ी (अजा)',
  'हरसिद्धि': 'हरसिद्धि (अजा)',
  'राजनगर': 'राजनगर (अजा)',
  'त्रिबेनीगंज': 'त्रिवेणीगंज (अजा)',
  'रानीगंज': 'रानीगंज (अजा)',
  'पिरपैंती': 'पीरपैंती (अजा)',
  'धोरैया': 'धोरैया (अजा)',
  'कटोरिया': 'कटोरिया (अजजा)',
  'मोहनिया': 'मोहनिया (अजा)',
  'मखदुमपुर': 'मक्दुमपुर (अजा)',
  'बोध गया': 'बोध गया (अजा)',
  'सिकंदरा': 'सिकंदरा (अजा)',
  
  // Regular mappings
  'गौरा-बौराम': 'गौरा बौराम', 'गौड़ा-बौराम': 'गौरा बौराम', 'गौड़ाबौराम': 'गौरा बौराम',
  'सिवान': 'सीवान', 'सिसवां': 'सीवान',
  'बिहार शरीफ': 'बिहारशरीफ',
  'वाल्मीकि नगर': 'वाल्मीकिनगर',
  'रुन्नी सैदपुर': 'रुन्नीसैदपुर', 'रुन्नीसैदपुर': 'रुन्नीसैदपुर',
  'मोहिउद्दीन नगर': 'मोहिउद्दीननगर',
  'बनिया पुर': 'बनियापुर',
  'बखरिया': 'बरहरिया',
  'सुलतान गंज': 'सुलतानगंज', 'सुल्तानगंज': 'सुलतानगंज',
  'बख्तियार पुर': 'बख्तियारपुर',
  'नाथ नगर': 'नाथनगर', 'नथनगर': 'नाथनगर',
  'दरभंगा ग्रामीण': 'दरभंगा',
  'कोचाधामन': 'कोचा धमन',
  'चेरिया-बरियारपुर': 'चेरिया बरियारपुर',
  'डुमरांव': 'डुमराव', 'डुमराँव': 'डुमराव',
  'पारू': 'पारो',
  'बिभूतिपुर': 'विभुतिपुर',
  'मढ़ौरा': 'माढ़ौरा',
  'फोरबिसगंज': 'फारबिसगंज',
  'कुचायकोट': 'कचांयकोट',
  'बेलहर': 'बेलहर',
  'कहलगाँव': 'कहलगांव', 'कहलगांव': 'कहलगांव',
  'चकाई': 'चकई',
  'वरसलीगंज': 'बर्सीलिगंज',
  'कांटी': 'कांति',
  'चिरैया': 'चिरैया',
  'गोबिंदपुर': 'गोविंदपुर',
  'गोविंदगंज': 'गोविन्दगंज',
  'आलमनगर': 'आलम नगर',
  'बिक्रमगंज': 'बिक्रम',
  'बाराुली': 'बरौली',
  'गरखा': 'गोरखा',
  'महराजगंज': 'महाराजगंज',
  'मरहौरा': 'मरहौरा',
  'बांकीपुर': 'बांकीपुर',
  'सन्देश': 'सुंदेश',
  'शेओहर': 'शिवहर',
  'सुरसंड': 'सुरसण्ड',
  'रुपौली': 'रूपौली',
  'नरहट': 'नरहट',
  'देहरी': 'देहरी',
  'कुर्था': 'कुर्था',
  'वजीरगंज': 'वज़ीरगंज',
  'भोरे': 'भोरे (अजा)',
  'गरखा': 'गरखा (अजा)',
  'बिभूतिपुर': 'विभूतिपुर',
  'बांका': 'बाँका',
  'फुलवारी': 'फुलवारी (अजा)',
  'मखदुमपुर': 'मखदुमपुर (अजा)',
  'रजौली': 'राजौली (अजा)',
  'दरौली': 'दरौली (अजा)',
  'राजगीर': 'राजगीर (अजा)',
  'अरराह': 'अररिया',
  'अगिआंव': 'अगिआंव (अजा)',
  'डुमराँव': 'डुमराँव',
  'डुमरांव': 'डुमराँव',
  'सन्देश': 'संदेश',
  'सुरसंड': 'सुरसन्ड',
  'रुन्नीसैदपुर': 'रून्नीसैदपुर',
  'पिरपैंती': 'पीरपैंती (अजा)',
  'सुलतानगंज': 'सुल्तानगंज',
  'चेनारी': 'चेनारी (अजा)',
  'कोरहा': 'कोराह (अजा)',
  'सकरा': 'सकरा (अजा)',
  'राजा पाकर': 'राजा पाकर (अजा)',
  'रोसड़ा': 'रोसड़ा (अजा)',
  'बछवारा': 'बछवाड़ा',
  'वरसलीगंज': 'वारिसलीगंज',
  'कुरहनी': 'कुढ़नी',
  'मरहौरा': 'मढ़ौरा',
  'बांकीपुर': 'बाँकीपुर',
  'गोबिंदपुर': 'गोबिन्दपुर',
  'पिरपैंती': 'पीरपैंती',
  'देहरी': 'डेहरी'
  // Note: नरहट, कुर्था not found in database - these constituencies may not exist
};

async function importRemainingCandidates() {
  try {
    console.log('🔄 Connecting to database...\n');
    
    // Get all parties first
    const [parties] = await db.query('SELECT id, short_code FROM Parties');
    const partyMap = {};
    parties.forEach(p => {
      partyMap[p.short_code] = p.id;
    });
    
    console.log('📋 Available parties:', Object.keys(partyMap).join(', '), '\n');
    
    // Get all constituencies
    const [constituencies] = await db.query('SELECT id, name_hindi FROM Constituencies');
    const constituencyMap = {};
    constituencies.forEach(c => {
      constituencyMap[c.name_hindi] = c.id;
    });
    
    console.log(`📍 Loaded ${constituencies.length} constituencies\n`);
    
    // Track statistics
    let totalImported = 0;
    let totalSkipped = 0;
    const skippedDetails = [];
    
    // Import each party
    for (const [partyCode, candidates] of Object.entries(allRemainingCandidates)) {
      console.log(`\n📦 Processing ${partyCode} (${candidates.length} candidates)...`);
      
      const partyId = partyMap[partyCode];
      if (!partyId) {
        console.log(`❌ Party ${partyCode} not found in database! Skipping...`);
        totalSkipped += candidates.length;
        continue;
      }
      
      let imported = 0;
      let skipped = 0;
      
      for (const [constituencyName, candidateName] of candidates) {
        // Try to find constituency (with mapping)
        const mappedName = nameMapping[constituencyName] || constituencyName;
        const constituencyId = constituencyMap[mappedName] || constituencyMap[constituencyName];
        
        if (!constituencyId) {
          skipped++;
          skippedDetails.push({
            party: partyCode,
            constituency: constituencyName,
            candidate: candidateName,
            reason: 'Constituency not found'
          });
          continue;
        }
        
        // Insert candidate
        try {
          await db.query(
            'INSERT INTO Candidates (name_hindi, constituency_id, party_id) VALUES (?, ?, ?)',
            [candidateName, constituencyId, partyId]
          );
          imported++;
        } catch (err) {
          skipped++;
          skippedDetails.push({
            party: partyCode,
            constituency: constituencyName,
            candidate: candidateName,
            reason: err.message
          });
        }
      }
      
      console.log(`  ✅ Imported: ${imported}`);
      console.log(`  ⚠️  Skipped: ${skipped}`);
      totalImported += imported;
      totalSkipped += skipped;
    }
    
    console.log('\n' + '='.repeat(60));
    console.log(`\n🎉 IMPORT COMPLETE!`);
    console.log(`   ✅ Total Imported: ${totalImported}`);
    console.log(`   ⚠️  Total Skipped: ${totalSkipped}`);
    
    if (skippedDetails.length > 0) {
      console.log(`\n⚠️  Skipped Details:`);
      skippedDetails.forEach((s, i) => {
        console.log(`   ${i + 1}. [${s.party}] ${s.constituency} - ${s.candidate}: ${s.reason}`);
      });
    }
    
    // Show final counts
    console.log('\n📊 Final candidate counts by party:');
    for (const partyCode of Object.keys(allRemainingCandidates)) {
      const partyId = partyMap[partyCode];
      if (partyId) {
        const [result] = await db.query(
          'SELECT COUNT(*) as count FROM Candidates WHERE party_id = ?',
          [partyId]
        );
        console.log(`   ${partyCode}: ${result[0].count} candidates`);
      }
    }
    
    // Show total
    const [totalResult] = await db.query('SELECT COUNT(*) as count FROM Candidates');
    console.log(`\n🎯 TOTAL CANDIDATES IN DATABASE: ${totalResult[0].count}`);
    
  } catch (error) {
    console.error('❌ Error:', error.message);
    throw error;
  } finally {
    await db.end();
  }
}

// Run the import
importRemainingCandidates()
  .then(() => {
    console.log('\n✅ Script completed successfully');
    process.exit(0);
  })
  .catch((error) => {
    console.error('\n❌ Script failed:', error);
    process.exit(1);
  });
