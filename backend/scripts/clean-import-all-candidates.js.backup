const db = require('../config/database');
const csvData = require('./clean-candidate-data.js');

console.log('\nüîÑ Starting CLEAN import of all candidates...\n');
console.log('‚ö†Ô∏è  This will DELETE all existing candidates and import fresh data!\n');

// Constituency name mapping for variations
const constituencyNameMap = {
  // Common variations
  '‡§ó‡•å‡§∞‡§æ-‡§¨‡•å‡§∞‡§æ‡§Æ': '‡§ó‡•å‡§∞‡§æ ‡§¨‡•å‡§∞‡§æ‡§Æ',
  '‡§ó‡•å‡§°‡§º‡§æ‡§¨‡•å‡§∞‡§æ‡§Æ': '‡§ó‡•å‡§∞‡§æ ‡§¨‡•å‡§∞‡§æ‡§Æ',
  '‡§∏‡•Ä‡§µ‡§æ‡§®': '‡§∏‡§ø‡§µ‡§æ‡§®',
  '‡§¨‡§ø‡§π‡§æ‡§∞ ‡§∂‡§∞‡•Ä‡§´': '‡§¨‡§ø‡§π‡§æ‡§∞‡§∂‡§∞‡•Ä‡§´',
  '‡§µ‡§æ‡§≤‡•ç‡§Æ‡•Ä‡§ï‡§ø ‡§®‡§ó‡§∞': '‡§µ‡§æ‡§≤‡•ç‡§Æ‡•Ä‡§ï‡§ø‡§®‡§ó‡§∞',
  '‡§ï‡•Å‡§∂‡•á‡§∂‡•ç‡§µ‡§∞ ‡§∏‡•ç‡§•‡§æ‡§®': '‡§ï‡•Å‡§∂‡•á‡§∂‡•ç‡§µ‡§∞ ‡§∏‡•ç‡§•‡§æ‡§® (‡§Ö‡§ú‡§æ)',
  '‡§ï‡•Å‡§∂‡•á‡§∂‡•ç‡§µ‡§∞‡§∏‡•ç‡§•‡§æ‡§®': '‡§ï‡•Å‡§∂‡•á‡§∂‡•ç‡§µ‡§∞ ‡§∏‡•ç‡§•‡§æ‡§® (‡§Ö‡§ú‡§æ)',
  '‡§™‡§ø‡§∞‡§™‡•à‡§Ç‡§§‡•Ä': '‡§™‡•Ä‡§∞‡§™‡•à‡§Ç‡§§‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§™‡•Ä‡§∞‡§™‡•à‡§Ç‡§§‡•Ä': '‡§™‡•Ä‡§∞‡§™‡•à‡§Ç‡§§‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§µ‡§∞‡§∏‡§≤‡•Ä‡§ó‡§Ç‡§ú': '‡§µ‡§æ‡§∞‡§ø‡§∏‡§≤‡•Ä‡§ó‡§Ç‡§ú',
  '‡§ó‡•ã‡§¨‡§ø‡§Ç‡§¶‡§™‡•Å‡§∞': '‡§ó‡•ã‡§¨‡§ø‡§®‡•ç‡§¶‡§™‡•Å‡§∞',
  '‡§¶‡•á‡§π‡§∞‡•Ä': '‡§°‡•á‡§π‡§∞‡•Ä',
  '‡§∏‡•Å‡§≤‡§§‡§æ‡§®‡§ó‡§Ç‡§ú': '‡§∏‡•Å‡§≤‡•ç‡§§‡§æ‡§®‡§ó‡§Ç‡§ú',
  '‡§¨‡§æ‡§Ç‡§ï‡§æ': '‡§¨‡§æ‡§Å‡§ï‡§æ',
  '‡§µ‡§ú‡•Ä‡§∞‡§ó‡§Ç‡§ú': '‡§µ‡§ú‡§º‡•Ä‡§∞‡§ó‡§Ç‡§ú',
  '‡§∞‡•Å‡§®‡•ç‡§®‡•Ä‡§∏‡•à‡§¶‡§™‡•Å‡§∞': '‡§∞‡•Ç‡§®‡•ç‡§®‡•Ä‡§∏‡•à‡§¶‡§™‡•Å‡§∞',
  '‡§Æ‡•ã‡§π‡§ø‡§â‡§¶‡•ç‡§¶‡•Ä‡§® ‡§®‡§ó‡§∞': '‡§Æ‡•ã‡§π‡§ø‡§â‡§¶‡•ç‡§¶‡•Ä‡§®‡§®‡§ó‡§∞',
  '‡§¨‡§ø‡§π‡§æ‡§∞‡•Ä‡§ó‡§Ç‡§ú': '‡§¨‡§ø‡§π‡§æ‡§∞‡•Ä‡§ó‡§Ç‡§ú',
  
  // SC/ST constituency mappings
  '‡§∞‡§æ‡§ú‡§®‡§ó‡§∞': '‡§∞‡§æ‡§ú‡§®‡§ó‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§∏‡§ø‡§Ç‡§π‡•á‡§∂‡•ç‡§µ‡§∞': '‡§∏‡§ø‡§Ç‡§π‡•á‡§∂‡•ç‡§µ‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§ï‡•Å‡§∂‡•á‡§∂‡•ç‡§µ‡§∞ ‡§∏‡•ç‡§•‡§æ‡§® (SC)': '‡§ï‡•Å‡§∂‡•á‡§∂‡•ç‡§µ‡§∞ ‡§∏‡•ç‡§•‡§æ‡§® (‡§Ö‡§ú‡§æ)',
  '‡§ï‡•Å‡§∂‡•á‡§∂‡•ç‡§µ‡§∞‡§∏‡•ç‡§•‡§æ‡§® (SC)': '‡§ï‡•Å‡§∂‡•á‡§∂‡•ç‡§µ‡§∞ ‡§∏‡•ç‡§•‡§æ‡§® (‡§Ö‡§ú‡§æ)',
  '‡§¨‡§•‡§®‡§æ‡§π‡§æ-SC': '‡§¨‡§•‡§®‡§æ‡§π‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§¨‡§•‡§®‡§æ‡§π‡§æ (SC)': '‡§¨‡§•‡§®‡§æ‡§π‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§Æ‡§®‡§ø‡§π‡§æ‡§∞‡•Ä': '‡§Æ‡§®‡§ø‡§π‡§æ‡§∞‡•Ä (‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ú‡§®‡§ú‡§æ‡§§‡§ø)',
  '‡§Æ‡§®‡§π‡§æ‡§∞‡•Ä-ST': '‡§Æ‡§®‡§ø‡§π‡§æ‡§∞‡•Ä (‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ú‡§®‡§ú‡§æ‡§§‡§ø)',
  '‡§Æ‡§®‡§ø‡§π‡§æ‡§∞‡•Ä (ST)': '‡§Æ‡§®‡§ø‡§π‡§æ‡§∞‡•Ä (‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ú‡§®‡§ú‡§æ‡§§‡§ø)',
  '‡§ï‡•ã‡§∞‡§π‡§æ-SC': '‡§ï‡•ã‡§¢‡§º‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§∏‡•ã‡§®‡§¨‡§∞‡§∏‡§æ-SC': '‡§∏‡•ã‡§®‡§¨‡§∞‡§∏‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§∏‡•ã‡§®‡§¨‡§∞‡§∏‡§æ (SC)': '‡§∏‡•ã‡§®‡§¨‡§∞‡§∏‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§∏‡§ï‡§∞‡§æ-SC': '‡§∏‡§ï‡§∞‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§∞‡§æ‡§ú‡§æ ‡§™‡§æ‡§ï‡§∞-SC': '‡§∞‡§æ‡§ú‡§æ ‡§™‡§æ‡§ï‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§∞‡•ã‡§∏‡§°‡§º‡§æ-SC': '‡§∞‡•ã‡§∏‡§°‡§º‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§¨‡•ã‡§ö‡§π‡§æ‡§Ç': '‡§¨‡•ã‡§ö‡§π‡§æ‡§Ç (‡§Ö‡§ú‡§æ)',
  '‡§¨‡•ã‡§ö‡§π‡§æ‡§Ç (SC)': '‡§¨‡•ã‡§ö‡§π‡§æ‡§Ç (‡§Ö‡§ú‡§æ)',
  '‡§≠‡•ã‡§∞‡•á': '‡§≠‡•ã‡§∞‡•á (‡§Ö‡§ú‡§æ)',
  '‡§≠‡•ã‡§∞‡•á (SC)': '‡§≠‡•ã‡§∞‡•á (‡§Ö‡§ú‡§æ)',
  '‡§™‡§æ‡§§‡•á‡§™‡•Å‡§∞': '‡§™‡§æ‡§§‡•á‡§™‡•Å‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§™‡§æ‡§§‡•á‡§™‡•Å‡§∞ (SC)': '‡§™‡§æ‡§§‡•á‡§™‡•Å‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§™‡•Ä‡§∞‡§™‡•à‡§Ç‡§§‡•Ä (SC)': '‡§™‡•Ä‡§∞‡§™‡•à‡§Ç‡§§‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§™‡§ø‡§∞‡§™‡•à‡§Ç‡§§‡•Ä (SC)': '‡§™‡•Ä‡§∞‡§™‡•à‡§Ç‡§§‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§´‡•Å‡§≤‡§µ‡§æ‡§∞‡•Ä': '‡§´‡•Å‡§≤‡§µ‡§æ‡§∞‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§´‡•Å‡§≤‡§µ‡§æ‡§∞‡•Ä (SC)': '‡§´‡•Å‡§≤‡§µ‡§æ‡§∞‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§Æ‡§∏‡•å‡§¢‡§º‡•Ä': '‡§Æ‡§∏‡•å‡§¢‡§º‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§Æ‡§∏‡•å‡§¢‡§º‡•Ä (SC)': '‡§Æ‡§∏‡•å‡§¢‡§º‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§Æ‡•ã‡§π‡§®‡§ø‡§Ø‡§æ': '‡§Æ‡•ã‡§π‡§®‡§ø‡§Ø‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§Æ‡•ã‡§π‡§®‡§ø‡§Ø‡§æ (SC)': '‡§Æ‡•ã‡§π‡§®‡§ø‡§Ø‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§ö‡•á‡§®‡§æ‡§∞‡•Ä': '‡§ö‡•á‡§®‡§æ‡§∞‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§ö‡•á‡§®‡§æ‡§∞‡•Ä-SC': '‡§ö‡•á‡§®‡§æ‡§∞‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§ö‡•á‡§®‡§æ‡§∞‡•Ä (SC)': '‡§ö‡•á‡§®‡§æ‡§∞‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§∞‡§æ‡§ú‡§™‡•Å‡§∞-SC': '‡§∞‡§æ‡§ú‡§™‡•Å‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§ï‡•Å‡§ü‡•Å‡§Ç‡§¨‡§æ-SC': '‡§ï‡•Å‡§ü‡•Å‡§Ç‡§¨‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§ï‡•Å‡§ü‡•Å‡§Ç‡§¨‡§æ (SC)': '‡§ï‡•Å‡§ü‡•Å‡§Ç‡§¨‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§á‡§Æ‡§æ‡§Æ‡§ó‡§Ç‡§ú': '‡§á‡§Æ‡§æ‡§Æ‡§ó‡§Ç‡§ú (‡§Ö‡§ú‡§æ)',
  '‡§á‡§Æ‡§æ‡§Æ‡§ó‡§Ç‡§ú (SC)': '‡§á‡§Æ‡§æ‡§Æ‡§ó‡§Ç‡§ú (‡§Ö‡§ú‡§æ)',
  '‡§¨‡§æ‡§∞‡§æ‡§ö‡§ü‡•ç‡§ü‡•Ä': '‡§¨‡§æ‡§∞‡§æ‡§ö‡§ü‡•ç‡§ü‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§¨‡§æ‡§∞‡§æ‡§ö‡§ü‡•ç‡§ü‡•Ä (SC)': '‡§¨‡§æ‡§∞‡§æ‡§ö‡§ü‡•ç‡§ü‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§∏‡§ø‡§Ç‡§π‡•á‡§∂‡•ç‡§µ‡§∞ (SC)': '‡§∏‡§ø‡§Ç‡§π‡•á‡§∂‡•ç‡§µ‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§∞‡§ú‡•å‡§≤‡•Ä': '‡§∞‡§æ‡§ú‡•å‡§≤‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§∞‡§ú‡•å‡§≤‡•Ä (SC)': '‡§∞‡§æ‡§ú‡•å‡§≤‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§Ü‡§≤‡§æ‡§â‡§≤‡•Ä': '‡§Ü‡§≤‡•å‡§≤‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§Ü‡§≤‡§æ‡§â‡§≤‡•Ä (SC)': '‡§Ü‡§≤‡•å‡§≤‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§Ö‡§≤‡•å‡§≤‡•Ä': '‡§Ü‡§≤‡•å‡§≤‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§Ö‡§≤‡•å‡§≤‡•Ä (SC)': '‡§Ü‡§≤‡•å‡§≤‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§π‡§∞‡§∏‡§ø‡§¶‡•ç‡§ß‡§ø': '‡§π‡§∞‡§∏‡§ø‡§¶‡•ç‡§ß‡§ø (‡§Ö‡§ú‡§æ)',
  '‡§π‡§∞‡§∏‡§ø‡§¶‡•ç‡§ß‡§ø (SC)': '‡§π‡§∞‡§∏‡§ø‡§¶‡•ç‡§ß‡§ø (‡§Ö‡§ú‡§æ)',
  '‡§¶‡§æ‡§®‡§æ‡§™‡•Å‡§∞': '‡§¶‡§æ‡§®‡§æ‡§™‡•Å‡§∞',
  '‡§∏‡§ø‡§ï‡§Ç‡§¶‡§∞‡§æ': '‡§∏‡§ø‡§ï‡§®‡•ç‡§¶‡§∞‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§∏‡§ø‡§ï‡§Ç‡§¶‡§∞‡§æ (SC)': '‡§∏‡§ø‡§ï‡§®‡•ç‡§¶‡§∞‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§ß‡•ã‡§∞‡•à‡§Ø‡§æ': '‡§ß‡•ã‡§∞‡•à‡§Ø‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§ß‡•ã‡§∞‡•à‡§Ø‡§æ (SC)': '‡§ß‡•ã‡§∞‡•à‡§Ø‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§ï‡§ü‡•ã‡§∞‡§ø‡§Ø‡§æ (ST)': '‡§ï‡§ü‡•ã‡§∞‡§ø‡§Ø‡§æ (‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ú‡§®‡§ú‡§æ‡§§‡§ø)',
  '‡§Æ‡§ñ‡§¶‡•Å‡§Æ‡§™‡•Å‡§∞': '‡§Æ‡§ñ‡§¶‡•Å‡§Æ‡§™‡•Å‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§Æ‡§ñ‡§¶‡•Å‡§Æ‡§™‡•Å‡§∞ (SC)': '‡§Æ‡§ñ‡§¶‡•Å‡§Æ‡§™‡•Å‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§¨‡•ã‡§ß ‡§ó‡§Ø‡§æ': '‡§¨‡•ã‡§ß ‡§ó‡§Ø‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§¨‡•ã‡§ß ‡§ó‡§Ø‡§æ (SC)': '‡§¨‡•ã‡§ß ‡§ó‡§Ø‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§¨‡•ã‡§ß‡§ó‡§Ø‡§æ': '‡§¨‡•ã‡§ß ‡§ó‡§Ø‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§¨‡•ã‡§ß‡§ó‡§Ø‡§æ (SC)': '‡§¨‡•ã‡§ß ‡§ó‡§Ø‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§ï‡§≤‡•ç‡§Ø‡§æ‡§£‡§™‡•Å‡§∞': '‡§ï‡§≤‡•ç‡§Ø‡§æ‡§£‡§™‡•Å‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§ï‡§≤‡•ç‡§Ø‡§æ‡§£‡§™‡•Å‡§∞ (SC)': '‡§ï‡§≤‡•ç‡§Ø‡§æ‡§£‡§™‡•Å‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§¶‡§∞‡•å‡§≤‡•Ä': '‡§¶‡§∞‡•å‡§≤‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§¶‡§∞‡•å‡§≤‡•Ä (SC)': '‡§¶‡§∞‡•å‡§≤‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§ó‡§∞‡§ñ‡§æ': '‡§ó‡§∞‡§ñ‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§ó‡§∞‡§ñ‡§æ (SC)': '‡§ó‡§∞‡§ñ‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§¨‡§ñ‡§∞‡•Ä': '‡§¨‡§ñ‡§∞‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§¨‡§ñ‡§∞‡•Ä (SC)': '‡§¨‡§ñ‡§∞‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§∞‡§æ‡§ú‡§ó‡•Ä‡§∞': '‡§∞‡§æ‡§ú‡§ó‡•Ä‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§∞‡§æ‡§ú‡§ó‡•Ä‡§∞ (SC)': '‡§∞‡§æ‡§ú‡§ó‡•Ä‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§Ö‡§ó‡§ø‡§Ü‡§Ç‡§µ': '‡§Ö‡§ó‡§ø‡§Ü‡§Ç‡§µ (‡§Ö‡§ú‡§æ)',
  '‡§Ö‡§ó‡§ø‡§Ü‡§Ç‡§µ (SC)': '‡§Ö‡§ó‡§ø‡§Ü‡§Ç‡§µ (‡§Ö‡§ú‡§æ)',
  '‡§§‡•ç‡§∞‡§ø‡§¨‡•á‡§®‡•Ä‡§ó‡§Ç‡§ú': '‡§§‡•ç‡§∞‡§ø‡§µ‡•á‡§£‡•Ä‡§ó‡§Ç‡§ú (‡§Ö‡§ú‡§æ)',
  '‡§§‡•ç‡§∞‡§ø‡§¨‡•á‡§®‡•Ä‡§ó‡§Ç‡§ú (SC)': '‡§§‡•ç‡§∞‡§ø‡§µ‡•á‡§£‡•Ä‡§ó‡§Ç‡§ú (‡§Ö‡§ú‡§æ)',
  '‡§∞‡§æ‡§®‡•Ä‡§ó‡§Ç‡§ú': '‡§∞‡§æ‡§®‡•Ä‡§ó‡§Ç‡§ú (‡§Ö‡§ú‡§æ)',
  '‡§∞‡§æ‡§®‡•Ä‡§ó‡§Ç‡§ú (SC)': '‡§∞‡§æ‡§®‡•Ä‡§ó‡§Ç‡§ú (‡§Ö‡§ú‡§æ)',
  '‡§¨‡§®‡§Æ‡§®‡§ñ‡•Ä': '‡§¨‡§®‡§Æ‡§®‡§ñ‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§¨‡§®‡§Æ‡§®‡§ñ‡•Ä (SC)': '‡§¨‡§®‡§Æ‡§®‡§ñ‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§¨‡§ñ‡§∞‡•Ä (‡§Ö‡§®‡•Å.‡§ú‡§æ‡§§‡§ø)': '‡§¨‡§ñ‡§∞‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§∞‡§ú‡•å‡§≤‡•Ä (‡§Ö‡§®‡•Å.‡§ú‡§æ‡§§‡§ø)': '‡§∞‡§æ‡§ú‡•å‡§≤‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§¨‡•ã‡§ß‡§ó‡§Ø‡§æ (‡§Ö‡§®‡•Å.‡§ú‡§æ‡§§‡§ø)': '‡§¨‡•ã‡§ß ‡§ó‡§Ø‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§ö‡•á‡§®‡§æ‡§∞‡•Ä (‡§Ö‡§®‡•Å.‡§ú‡§æ‡§§‡§ø)': '‡§ö‡•á‡§®‡§æ‡§∞‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§á‡§Æ‡§æ‡§Æ‡§ó‡§Ç‡§ú (‡§Ö.‡§ú‡§æ.)': '‡§á‡§Æ‡§æ‡§Æ‡§ó‡§Ç‡§ú (‡§Ö‡§ú‡§æ)',
  '‡§¨‡§æ‡§∞‡§æ‡§ö‡§ü‡•ç‡§ü‡•Ä (‡§Ö.‡§ú‡§æ.)': '‡§¨‡§æ‡§∞‡§æ‡§ö‡§ü‡•ç‡§ü‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§∏‡§ø‡§ï‡§Ç‡§¶‡§∞‡§æ (‡§Ö.‡§ú‡§æ.)': '‡§∏‡§ø‡§ï‡§®‡•ç‡§¶‡§∞‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§ï‡•Å‡§ü‡•Å‡§Ç‡§¨‡§æ (‡§Ö.‡§ú‡§æ.)': '‡§ï‡•Å‡§ü‡•Å‡§Ç‡§¨‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§™‡•Ä‡§∞‡§™‡•à‡§Ç‡§§‡•Ä (‡§Ö.‡§ú‡§æ.)': '‡§™‡•Ä‡§∞‡§™‡•à‡§Ç‡§§‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§ï‡•Å‡§∂‡•á‡§∂‡•ç‡§µ‡§∞‡§∏‡•ç‡§•‡§æ‡§® (‡§Ö.‡§ú‡§æ.)': '‡§ï‡•Å‡§∂‡•á‡§∂‡•ç‡§µ‡§∞ ‡§∏‡•ç‡§•‡§æ‡§® (‡§Ö‡§ú‡§æ)',
  '‡§≠‡•ã‡§∞‡•á (‡§Ö.‡§ú‡§æ.)': '‡§≠‡•ã‡§∞‡•á (‡§Ö‡§ú‡§æ)',
  '‡§¨‡§•‡§®‡§æ‡§π‡§æ (‡§Ö.‡§ú‡§æ.)': '‡§¨‡§•‡§®‡§æ‡§π‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§∞‡§æ‡§ú‡§®‡§ó‡§∞ (‡§Ö.‡§ú‡§æ.)': '‡§∞‡§æ‡§ú‡§®‡§ó‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§∏‡§ø‡§Ç‡§π‡•á‡§∂‡•ç‡§µ‡§∞ ‡§Ö0‡§ú‡§æ0': '‡§∏‡§ø‡§Ç‡§π‡•á‡§∂‡•ç‡§µ‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§∏‡•ã‡§®‡§¨‡§∞‡§∏‡§æ (‡§Ö.‡§ú‡§æ.)': '‡§∏‡•ã‡§®‡§¨‡§∞‡§∏‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§ï‡•Å‡§∂‡•á‡§∂‡•ç‡§µ‡§∞‡§∏‡•ç‡§•‡§æ‡§® (‡§Ö.‡§ú‡§æ.)': '‡§ï‡•Å‡§∂‡•á‡§∂‡•ç‡§µ‡§∞ ‡§∏‡•ç‡§•‡§æ‡§® (‡§Ö‡§ú‡§æ)',
  '‡§∞‡§æ‡§ú‡§æ‡§™‡§æ‡§ï‡§∞': '‡§∞‡§æ‡§ú‡§æ ‡§™‡§æ‡§ï‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§∞‡§æ‡§ú‡§æ‡§™‡§æ‡§ï‡§∞ (‡§Ö.‡§ú‡§æ.)': '‡§∞‡§æ‡§ú‡§æ ‡§™‡§æ‡§ï‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§ï‡§≤‡•ç‡§Ø‡§æ‡§£‡§™‡•Å‡§∞ (‡§Ö.‡§ú‡§æ.)': '‡§ï‡§≤‡•ç‡§Ø‡§æ‡§£‡§™‡•Å‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§Ü‡§≤‡•å‡§≤‡•Ä (‡§Ö.‡§ú‡§æ.)': '‡§Ü‡§≤‡•å‡§≤‡•Ä (‡§Ö‡§ú‡§æ)',
  '‡§™‡§æ‡§§‡•á‡§™‡•Å‡§∞ (‡§Ö.‡§ú‡§æ.)': '‡§™‡§æ‡§§‡•á‡§™‡•Å‡§∞ (‡§Ö‡§ú‡§æ)',
  '‡§∏‡§ï‡§∞‡§æ (‡§Ü0‡§ú‡§æ0)': '‡§∏‡§ï‡§∞‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§ï‡•ã‡§¢‡§º‡§æ (‡§Ö.‡§ú‡§æ.)': '‡§ï‡•ã‡§¢‡§º‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§ï‡§ü‡•ã‡§∞‡§ø‡§Ø‡§æ (‡§Ö‡§ú‡§ú‡§æ)': '‡§ï‡§ü‡•ã‡§∞‡§ø‡§Ø‡§æ (‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ú‡§®‡§ú‡§æ‡§§‡§ø)',
  '‡§Æ‡§®‡§ø‡§π‡§æ‡§∞‡•Ä (‡§Ö.‡§ú.‡§ú‡§æ.)': '‡§Æ‡§®‡§ø‡§π‡§æ‡§∞‡•Ä (‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ú‡§®‡§ú‡§æ‡§§‡§ø)',
  '‡§ß‡•ã‡§∞‡•à‡§Ø‡§æ (‡§Ö.‡§ú‡§æ.)': '‡§ß‡•ã‡§∞‡•à‡§Ø‡§æ (‡§Ö‡§ú‡§æ)',
  '‡§§‡•ç‡§∞‡§ø‡§µ‡•á‡§£‡•Ä‡§ó‡§Ç‡§ú (‡§Ö.‡§ú‡§æ.)': '‡§§‡•ç‡§∞‡§ø‡§µ‡•á‡§£‡•Ä‡§ó‡§Ç‡§ú (‡§Ö‡§ú‡§æ)',
  '‡§∞‡§æ‡§®‡•Ä‡§ó‡§Ç‡§ú (‡§Ö.‡§ú‡§æ.)': '‡§∞‡§æ‡§®‡•Ä‡§ó‡§Ç‡§ú (‡§Ö‡§ú‡§æ)',
  '‡§¨‡§æ‡§Å‡§ï‡§æ': '‡§¨‡§æ‡§Å‡§ï‡§æ',
  '‡§¨‡§æ‡§Ç‡§ï‡•Ä‡§™‡•Å‡§∞': '‡§¨‡§æ‡§Å‡§ï‡•Ä‡§™‡•Å‡§∞'
};

// Party code mapping
const partyCodeMap = {
  'BJP': 'BJP',
  'JDU': 'JDU',
  'JAN_SURAJ': 'JAN_SURAJ',
  'LJPRV': 'LJPRV',
  'HAMS': 'HAMS',
  'RLM': 'RLM',
  'AAP': 'AAP',
  'AIMIM': 'AIMIM',
  'CPIM': 'CPIM',
  'CPIML': 'CPIML',
  'JJD': 'JJD',
  'VIP': 'VIP',
  'INC': 'INC',
  'RJD': 'RJD'
};

async function deleteAllCandidates() {
  console.log('üóëÔ∏è  Deleting all existing candidates...');
  const [result] = await db.query('DELETE FROM Candidates');
  console.log(`   ‚úÖ Deleted ${result.affectedRows} candidates\n`);
  return result.affectedRows;
}

async function getPartyId(partyCode) {
  const mappedCode = partyCodeMap[partyCode] || partyCode;
  const [rows] = await db.query(
    'SELECT id FROM Parties WHERE short_code = ?',
    [mappedCode]
  );
  if (rows.length === 0) {
    throw new Error(`‚ùå Party not found: ${partyCode} (mapped to ${mappedCode})`);
  }
  return rows[0].id;
}

async function getConstituencyId(constituencyName) {
  // Try direct match first
  let [rows] = await db.query(
    'SELECT id FROM Constituencies WHERE name_hindi = ?',
    [constituencyName]
  );
  
  if (rows.length > 0) {
    return rows[0].id;
  }
  
  // Try mapped name
  const mappedName = constituencyNameMap[constituencyName];
  if (mappedName) {
    [rows] = await db.query(
      'SELECT id FROM Constituencies WHERE name_hindi = ?',
      [mappedName]
    );
    if (rows.length > 0) {
      return rows[0].id;
    }
  }
  
  return null;
}

async function importCandidates() {
  let totalImported = 0;
  let totalSkipped = 0;
  const skippedDetails = [];
  
  console.log('üì• Importing candidates from all parties...\n');
  
  for (const [party, candidates] of Object.entries(csvData)) {
    console.log(`üì¶ Processing ${party} (${candidates.length} candidates)...`);
    
    try {
      const partyId = await getPartyId(party);
      let imported = 0;
      let skipped = 0;
      
      for (const [constituency, candidateName] of candidates) {
        const constituencyId = await getConstituencyId(constituency);
        
        if (!constituencyId) {
          skipped++;
          skippedDetails.push({
            party,
            constituency,
            candidate: candidateName
          });
          continue;
        }
        
        await db.query(
          'INSERT INTO Candidates (name_hindi, party_id, constituency_id) VALUES (?, ?, ?)',
          [candidateName, partyId, constituencyId]
        );
        imported++;
      }
      
      console.log(`   ‚úÖ Imported: ${imported}, ‚è≠Ô∏è  Skipped: ${skipped}`);
      totalImported += imported;
      totalSkipped += skipped;
      
    } catch (error) {
      console.error(`   ‚ùå Error importing ${party}:`, error.message);
    }
  }
  
  console.log(`\n\n${'='.repeat(60)}`);
  console.log(`üìä IMPORT SUMMARY:`);
  console.log(`${'='.repeat(60)}`);
  console.log(`   ‚úÖ Total Imported: ${totalImported}`);
  console.log(`   ‚è≠Ô∏è  Total Skipped: ${totalSkipped}`);
  console.log(`${'='.repeat(60)}\n`);
  
  if (skippedDetails.length > 0) {
    console.log(`‚ö†Ô∏è  Skipped Candidates (constituency not found):`);
    skippedDetails.forEach(({ party, constituency, candidate }) => {
      console.log(`   ${party}: ${constituency} - ${candidate}`);
    });
    console.log('');
  }
  
  return { totalImported, totalSkipped };
}

async function verifyImport() {
  console.log('üîç Verifying import...\n');
  
  // Get counts by party
  const [counts] = await db.query(`
    SELECT 
      p.short_code,
      p.name_hindi,
      COUNT(c.id) as count
    FROM Parties p
    LEFT JOIN Candidates c ON p.id = c.party_id
    WHERE p.short_code IN ('BJP', 'JDU', 'JAN_SURAJ', 'LJPRV', 'HAMS', 'RLM', 'AAP', 'AIMIM', 'CPIM', 'CPIML', 'JJD', 'VIP', 'INC', 'RJD')
    GROUP BY p.id
    ORDER BY p.short_code
  `);
  
  console.log('üìä Candidate Counts by Party:');
  console.log('‚îÄ'.repeat(60));
  let grandTotal = 0;
  counts.forEach(row => {
    console.log(`   ${row.short_code.padEnd(12)} : ${row.count} candidates`);
    grandTotal += row.count;
  });
  console.log('‚îÄ'.repeat(60));
  console.log(`   ${'TOTAL'.padEnd(12)} : ${grandTotal} candidates`);
  console.log('‚ïê'.repeat(60));
  
  // Show sample candidates
  const [samples] = await db.query(`
    SELECT 
      c.name_hindi,
      p.short_code,
      con.name_hindi as constituency
    FROM Candidates c
    JOIN Parties p ON c.party_id = p.id
    JOIN Constituencies con ON c.constituency_id = con.id
    ORDER BY RAND()
    LIMIT 5
  `);
  
  console.log('\nüìã Sample Candidates:');
  samples.forEach(row => {
    console.log(`   ${row.short_code} - ${row.name_hindi} (${row.constituency})`);
  });
  console.log('');
}

async function main() {
  try {
    console.log('‚ïê'.repeat(60));
    console.log('  CLEAN IMPORT OF ALL CANDIDATES');
    console.log('‚ïê'.repeat(60));
    console.log(`  Total candidates to import: ${Object.values(csvData).flat().length}`);
    console.log('‚ïê'.repeat(60));
    console.log('');
    
    // Step 1: Delete all existing candidates
    await deleteAllCandidates();
    
    // Step 2: Import fresh data
    const { totalImported, totalSkipped } = await importCandidates();
    
    // Step 3: Verify
    await verifyImport();
    
    console.log('‚úÖ Import completed successfully!\n');
    
  } catch (error) {
    console.error('‚ùå Error:', error);
    process.exit(1);
  } finally {
    await db.end();
  }
}

main();
